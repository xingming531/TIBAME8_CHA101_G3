<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>房型資訊管理</title>
    <link rel="stylesheet"
          href="/hotel/assets17/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i&amp;display=swap">
    <link rel="stylesheet"
          href="/hotel/assets17/fonts/fontawesome-all.min.css">
    <link rel="stylesheet" href="/hotel/assets17/css/custom.css">
    <link rel="stylesheet"
          href="/hotel/assets17/css/Ludens---3-Edit-Dark-mode.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.2.0/css/bootstrap.min.css">
    <link rel="stylesheet"
          href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script
            src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
    <script
            src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>
    <link rel="shortcut icon" href="/assets/img/fav_icon.png" type="image/x-icon">
</head>

<body id="page-top">
<div id="wrapper">
    <nav
            class="navbar navbar-dark align-items-start sidebar sidebar-dark accordion bg-gradient-primary p-0"
            style="background: #f1ecd1;">
        <div class="container-fluid d-flex flex-column p-0">
            <a
                    class="navbar-brand d-flex justify-content-center align-items-center sidebar-brand m-0"
                    href="#">
                <div class="sidebar-brand-text mx-3">
                    <img width="59" height="33"
                         src="./assets17/img/avatars/logo-only.png">
                </div>
            </a>
            <hr class="sidebar-divider my-0">
            <ul class="navbar-nav">
                <li class="nav-item dropdown show"><a
                        class="dropdown-toggle nav-link" aria-expanded="true"
                        data-bs-toggle="dropdown" data-bs-auto-close="false" href="#"
                        style="color: #a67c52; padding: 5px 16px; font-weight: bold; font-size: 14px;">帳號管理</a>
                    <div class="dropdown-menu show" data-bs-popper="none"
                         style="background: rgba(255, 255, 255, 0); border-style: none; padding: 0px; margin: 0px; margin-bottom: 5px;">
                        <a class="dropdown-item" href="../owner/OwnerAccount.html"
                           style="padding: 2px 30px; font-size: 13px;">基本資料</a>
                        <div class="dropdown-divider"
                             style="border-color: rgb(255, 255, 255);"></div>
                    </div>
                </li>
                <li class="nav-item dropdown show"><a
                        class="dropdown-toggle nav-link" aria-expanded="true"
                        data-bs-toggle="dropdown" data-bs-auto-close="false" href="#"
                        style="color: #a67c52; padding: 5px 16px; font-weight: bold; font-size: 14px;">房間管理</a>
                    <div class="dropdown-menu show" data-bs-popper="none"
                         style="background: rgba(255, 255, 255, 0); border-style: none; padding: 0px; margin: 0px; margin-bottom: 5px;">
                        <a class="dropdown-item" href="roomType.html"
                           style="padding: 2px 30px; font-size: 13px;">房型資訊</a><a
                            class="dropdown-item" href="room.html"
                            style="padding: 2px 30px; font-size: 13px;">房間資訊</a>
                    </div>
                </li>
                <li class="nav-item dropdown show"><a
                        class="dropdown-toggle nav-link" aria-expanded="true"
                        data-bs-toggle="dropdown" data-bs-auto-close="false" href="#"
                        style="color: #a67c52; padding: 5px 16px; font-weight: bold; font-size: 14px;">訂單管理</a>
                    <div class="dropdown-menu show" data-bs-popper="none"
                         style="background: rgba(255, 255, 255, 0); border-style: none; padding: 0px; margin: 0px; margin-bottom: 5px;">
                        <a class="dropdown-item" href="../f_27/hotel-orders.html"
                           style="padding: 2px 30px; font-size: 13px;">訂單管理</a>
                        <div class="dropdown-divider"
                             style="border-color: rgb(255, 255, 255);"></div>
                    </div>
                </li>
            </ul>
            <div class="text-center d-none d-md-inline">
                <button class="btn rounded-circle border-0" id="sidebarToggle"
                        type="button"></button>
            </div>
        </div>
    </nav>

    <div class="d-flex flex-column" id="content-wrapper">
        <div id="content">
            <nav
                    class="navbar navbar-light navbar-expand bg-white shadow mb-4 topbar static-top">
                <div class="container-fluid">
                    <button class="btn btn-link d-md-none rounded-circle me-3"
                            id="sidebarToggleTop" type="button">
                        <i class="fas fa-bars"></i>
                    </button>
                    <ul class="navbar-nav flex-nowrap ms-auto">
                        <li class="nav-item dropdown no-arrow">
                            <div class="nav-item dropdown no-arrow">
                                <a class="dropdown-toggle nav-link" aria-expanded="false"
                                   data-bs-toggle="dropdown" href="#"><span id="owner-name"
                                        class="d-none d-lg-inline me-2 text-gray-600 small"></span></a>
                                <div
                                        class="dropdown-menu shadow dropdown-menu-end animated--grow-in"
                                        style="min-width: 110px;">
                                    <a class="dropdown-item" href="#" onclick="logout()"><i
                                            class="fas fa-sign-out-alt fa-sm fa-fw me-2 text-gray-400"></i>&nbsp;Logout</a>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </nav>
            <div class="container-fluid">
                <h3 class="text-dark mb-4">房型資訊</h3>
                <div class="card shadow">
                    <div class="card-header py-3">
                        <!-- Button -->
                        <button type="button" class="btn btn-primary btn-modify"
                                onclick="window.location.href='addRoomType.html'">
                            新增房型資訊
                        </button>

                    </div>
                    <div class="card-body">
                        <div class="table-responsive table mt-2" id="dataTable"
                             role="grid" aria-describedby="dataTable_info">
                            <table id="myTable" class="table table-striped"
                                   style="width: 100%">
                                <thead>
                                <tr>
                                    <th>房型名稱</th>
                                    <th>房間數量</th>
                                    <th>房型價格</th>
                                    <th>寵物種類</th>
                                    <th>寵物尺寸</th>
                                    <th>房型介紹</th>
                                    <th>上下架狀態</th>
                                    <th>編輯/查看</th>
                                </tr>
                                </thead>
                                <tbody id="room-data-list">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <footer class="bg-white sticky-footer">
            <div class="container my-auto">
                <div class="text-center my-auto copyright">
                    <span>Copyright © Brand 2023</span>
                </div>
            </div>
        </footer>
    </div>
    <a class="border rounded d-inline scroll-to-top" href="#page-top"><i
            class="fas fa-angle-up"></i></a>
</div>
<script src="/hotel/assets17/bootstrap/js/bootstrap.min.js"></script>
<script src="/hotel/assets17/js/theme.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<!-- jQuery -->
<script type="text/javascript" charset="utf8"
        src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

<!-- DataTables -->
<script type="text/javascript" charset="utf8"
        src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.js"></script>
<script src="../assets/js/hotel_owner_login.js"></script>

<script>
    $(document).ready(function() {
        const ownerName = getHotelOwnerName();
        if (ownerName) {
            $('#owner-name').text(ownerName);
        }
    });
    function limitTextLength() {
        $('.limited-text').each(function () {
            var text = $(this).text();
            if (text.length > 10) {
                $(this).text(text.substring(0, 10) + '...');
            }
        });
    }

    $(document).ready(function () {
        const hotelId = getHotelOwnerId();
        console.log(hotelId);
        $.ajax({
            url: `/roomTypes/hotelId/${hotelId}`,
            type: 'GET',

            success: function (response) {
                let html = '';
                for (let i = 0; i < response.length; i++) {
                    let roomType = response[i];
                    const sizeString = getSizeString(roomType.roomTypeSize);

                    html += `<tr>
	                    <td>${roomType.roomTypeName}</td>
	                    <td>${roomType.roomTypeAmount}</td>
	                    <td>${roomType.roomTypePrice}</td>
	                    <td>${roomType.roomPetType}</td>
	                    <td>${sizeString}</td>
	                    <td class="limited-text">${roomType.roomTypeAbout}</td>
	                    <td>${roomType.roomTypeSaleStatus === "0" ? "下架" : "上架"}</td>
	                    <td><button type="button" class="btn btn-primary btn-modify btn-edit" data-room-type-id="${roomType.roomTypeId}">編輯</button></td>
	                </tr>`;
                }
                $("#room-data-list").html(html);
                limitTextLength();  // 房型介紹字數限制
                $('#myTable').DataTable({//初始化DataTable
                    "language": {
                        "lengthMenu": "顯示 _MENU_ 條",
                        "zeroRecords": "未找到任何資料",
                        "info": "顯示頁數 _PAGE_ / _PAGES_",
                        "infoEmpty": "沒有任何資訊",
                        "infoFiltered": "(從 _MAX_ 條資料中篩選)",
                        "search": "搜尋:",
                        "paginate": {
                            "first": "第一頁",
                            "last": "最後一頁",
                            "next": "下一頁",
                            "previous": "上一頁"
                        },
                    }
                });
            },
            error: function (xhr, textStatus, errorThrown) {
                console.error(xhr);
                if (xhr.status === 401) {
                    msg.show();
                }
            }
        });
    });

    function getSizeString(type) {
        switch (type) {
            case "0":
                return "小型";
            case "1":
                return "中型";
            case "2":
                return "大型";
            default:
                return undefined;
        }
    }
</script>
<script>
    //按下編輯會導向編輯網頁
    $(document).ready(function () {
        $("#room-data-list").on("click", ".btn-edit", function () {
            var roomTypeId = $(this).data("room-type-id");
            window.location.href = "editRoomType.html?roomTypeId=" + roomTypeId;
        });
    });
</script>

</body>

</html>